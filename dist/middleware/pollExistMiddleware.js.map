{"version":3,"sources":["../../src/middleware/pollExistMiddleware.js"],"names":["mongodb","require","module","exports","req","res","next","poll_id","body","db","app","get","pollCollection","collection","findOneAsync","_id","ObjectID","poll","rest","forbidden","message"],"mappings":";;;;;;;;;;;;AAAA,IAAMA,UAAUC,QAAQ,SAAR,CAAhB;AACAC,OAAOC,OAAP,GAAiB,UAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACnC,MAAMC,UAAUH,IAAII,IAAJ,CAASD,OAAzB;AACA,MAAI,CAACA,OAAL,EACED;AACF,MAAMG,KAAKL,IACRM,GADQ,CAERC,GAFQ,CAEJ,IAFI,CAAX;AAGA,MAAMC,iBAAiBH,GAAGI,UAAH,CAAc,MAAd,CAAvB;AACA,6DAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAEoBD,eAAeE,YAAf,CAA4B;AAC3CC,mBAAK,IAAIf,QAAQgB,QAAZ,CAAqBT,OAArB;AADsC,aAA5B,CAFpB;;AAAA;AAEOU,gBAFP;;AAKG,gBAAI,CAACA,IAAL,EACEZ,IAAIa,IAAJ,CAASC,SAAT,CAAmB,wBAAnB,EADF,KAGEb;AARL;AAAA;;AAAA;AAAA;AAAA;;AAUG,gBAAI,YAAIc,OAAR,EACE,cAAM,YAAIA,OAAV;AACFf,gBACGa,IADH,CAEGC,SAFH;;AAZH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAD;AAiBD,CAzBD","file":"pollExistMiddleware.js","sourcesContent":["const mongodb = require('mongodb');\r\nmodule.exports = (req, res, next) => {\r\n  const poll_id = req.body.poll_id;\r\n  if (!poll_id) \r\n    next();\r\n  const db = req\r\n    .app\r\n    .get('db');\r\n  const pollCollection = db.collection('poll');\r\n  (async() => {\r\n    try {\r\n      let poll = await pollCollection.findOneAsync({\r\n        _id: new mongodb.ObjectID(poll_id)\r\n      })\r\n      if (!poll) \r\n        res.rest.forbidden('Poll Id does not exist');\r\n      else \r\n        next()\r\n    } catch (err) {\r\n      if (err.message) \r\n        err = err.message;\r\n      res\r\n        .rest\r\n        .forbidden(err)\r\n    }\r\n  })();\r\n};\r\n"]}