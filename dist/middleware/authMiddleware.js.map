{"version":3,"sources":["../../src/middleware/authMiddleware.js"],"names":["pino","require","module","exports","req","res","next","jwt","get","rest","unauthorized","replace","trim","decoded","userEmail","email","userId","_id"],"mappings":";;;;;;;;;;AACA;;;;AADA,IAAMA,OAAOC,QAAQ,MAAR,GAAb;;AAEAC,OAAOC,OAAP,GAAiB,UAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACnC,MAAIC,MAAMH,IAAII,GAAJ,CAAQ,eAAR,CAAV;AACA,MAAI,CAACD,GAAL,EACEF,IAAII,IAAJ,CAASC,YAAT,CAAuB,cAAvB;AACFH,QAAMA,IAAII,OAAJ,CAAY,KAAZ,EAAmB,EAAnB,CAAN;AACAJ,QAAMA,IAAIK,IAAJ,EAAN;AACA,6DAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAEyB,qBAAUL,GAAV,CAFzB;;AAAA;AAESM,mBAFT;;AAGGT,gBAAIU,SAAJ,GAAgBD,QAAQE,KAAxB;AACAX,gBAAIY,MAAJ,GAAaH,QAAQI,GAArB;AACAX;AALH;AAAA;;AAAA;AAAA;AAAA;;AAOGA;;AAPH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAD;AAUD,CAhBD","file":"authMiddleware.js","sourcesContent":["const pino = require(\"pino\")();\r\nimport {verifyJwt} from \"../lib/util\";\r\nmodule.exports = (req, res, next) => {\r\n  let jwt = req.get(\"Authorization\");\r\n  if (!jwt) \r\n    res.rest.unauthorized((\"Unauthorized\"));\r\n  jwt = jwt.replace(\"JWT\", \"\");\r\n  jwt = jwt.trim();\r\n  (async() => {\r\n    try {\r\n      const decoded = await verifyJwt(jwt);\r\n      req.userEmail = decoded.email;\r\n      req.userId = decoded._id;\r\n      next();\r\n    } catch (err) {\r\n      next(err);\r\n    }\r\n  })();\r\n};\r\n"]}